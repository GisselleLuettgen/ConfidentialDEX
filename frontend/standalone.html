<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DeFi Platform - ç‹¬ç«‹ç‰ˆæœ¬</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://cdn.ethers.io/lib/ethers-5.7.umd.min.js"></script>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #0f0f23 0%, #1a1a2e 50%, #16213e 100%);
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            color: white;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
        }

        .card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }

        .btn {
            background: linear-gradient(45deg, #3B82F6, #8B5CF6);
            border: none;
            border-radius: 8px;
            color: white;
            padding: 12px 24px;
            margin: 10px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn:hover {
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(59, 130, 246, 0.5);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .input {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            color: white;
            padding: 12px;
            margin: 10px 0;
            width: 200px;
        }

        .status {
            padding: 15px;
            margin: 15px 0;
            border-radius: 8px;
            text-align: center;
        }

        .success { 
            background: rgba(16, 185, 129, 0.2);
            border: 1px solid rgba(16, 185, 129, 0.5);
        }

        .error { 
            background: rgba(239, 68, 68, 0.2);
            border: 1px solid rgba(239, 68, 68, 0.5);
        }

        .info { 
            background: rgba(59, 130, 246, 0.2);
            border: 1px solid rgba(59, 130, 246, 0.5);
        }

        .project {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 20px;
            margin: 15px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 style="text-align: center; font-size: 2.5em; margin-bottom: 30px;">
            ğŸš€ <span style="background: linear-gradient(45deg, #3B82F6, #8B5CF6); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent;">DeFi Platform</span>
        </h1>

        <div class="card">
            <h2>ğŸ’ æŠ•èµ„æµ‹è¯•åŒº</h2>
            <p>æµ‹è¯•MetaMaskæŠ•èµ„äº¤äº’åŠŸèƒ½</p>
            
            <div>
                <button class="btn" onclick="connectWallet()">ğŸ”— è¿æ¥MetaMaské’±åŒ…</button>
                <button class="btn btn-secondary" onclick="testInvestment()">ğŸ’° æµ‹è¯•æŠ•èµ„åŠŸèƒ½</button>
            </div>
            
            <div id="wallet-status" class="status info">
                é’±åŒ…çŠ¶æ€: æœªè¿æ¥
            </div>

            <div>
                <h3>å¿«é€ŸæŠ•èµ„æµ‹è¯•:</h3>
                <input type="number" id="invest-amount" class="input" placeholder="æŠ•èµ„é‡‘é¢ (ETH)" value="0.001" step="0.001">
                <button class="btn" onclick="quickInvest()">âš¡ å¿«é€ŸæŠ•èµ„</button>
            </div>
        </div>

        <div class="card">
            <h2>ğŸ“ˆ DEX äº¤æ˜“æµ‹è¯•åŒº</h2>
            <div>
                <input type="number" id="trade-amount" class="input" placeholder="æ•°é‡" value="100" step="0.001">
                <input type="number" id="trade-price" class="input" placeholder="ä»·æ ¼" value="0.0004" step="0.0001">
                <button class="btn" onclick="testTrade('buy')">ğŸš€ æµ‹è¯•ä¹°å…¥</button>
                <button class="btn btn-secondary" onclick="testTrade('sell')">ğŸ“‰ æµ‹è¯•å–å‡º</button>
            </div>
        </div>

        <div class="card">
            <h2>ğŸ“œ æ¨¡æ‹Ÿé¡¹ç›®åˆ—è¡¨</h2>
            <div class="project">
                <h3>DeFi Privacy Tools</h3>
                <p>ä½¿ç”¨é›¶çŸ¥è¯†è¯æ˜æ„å»ºä¸‹ä¸€ä»£DeFiéšç§å·¥å…·</p>
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <span>ç›®æ ‡: 100 ETH | å·²ç­¹é›†: 45.7 ETH</span>
                    <button class="btn" onclick="investInProject('project1')">ğŸ’ æ”¯æŒé¡¹ç›®</button>
                </div>
            </div>
            
            <div class="project">
                <h3>Confidential NFT Marketplace</h3>
                <p>æ”¯æŒéšç§ä»·æ ¼å’Œç§äººäº¤æ˜“çš„NFTå¸‚åœº</p>
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <span>ç›®æ ‡: 250 ETH | å·²ç­¹é›†: 182.3 ETH</span>
                    <button class="btn" onclick="investInProject('project2')">ğŸ’ æ”¯æŒé¡¹ç›®</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        let provider = null;
        let signer = null;
        let account = null;

        function updateStatus(message, type = 'info') {
            const statusEl = document.getElementById('wallet-status');
            statusEl.textContent = message;
            statusEl.className = `status ${type}`;
        }

        async function connectWallet() {
            console.log('Connecting wallet...');
            try {
                if (!window.ethereum) {
                    updateStatus('âŒ MetaMaskæœªå®‰è£…ï¼è¯·å®‰è£…MetaMaskæµè§ˆå™¨æ‰©å±•', 'error');
                    return;
                }

                const accounts = await window.ethereum.request({
                    method: 'eth_requestAccounts',
                });

                if (accounts.length > 0) {
                    provider = new ethers.providers.Web3Provider(window.ethereum);
                    signer = provider.getSigner();
                    account = accounts[0];

                    const balance = await provider.getBalance(account);
                    const balanceEth = ethers.utils.formatEther(balance);

                    updateStatus(`âœ… é’±åŒ…å·²è¿æ¥: ${account.slice(0, 6)}...${account.slice(-4)} | ä½™é¢: ${parseFloat(balanceEth).toFixed(4)} ETH`, 'success');
                }
            } catch (error) {
                console.error('Wallet connection error:', error);
                updateStatus(`âŒ è¿æ¥å¤±è´¥: ${error.message}`, 'error');
            }
        }

        async function testInvestment() {
            console.log('Testing investment...');
            if (!signer) {
                updateStatus('âŒ è¯·å…ˆè¿æ¥é’±åŒ…', 'error');
                return;
            }

            try {
                updateStatus('ğŸ¦Š æ­£åœ¨æ‰“å¼€MetaMaskï¼Œè¯·ç¡®è®¤äº¤æ˜“...', 'info');
                
                const tx = await signer.sendTransaction({
                    to: '0x742d35Cc6634C0532925a3b8D4b8A8FD7E5Da4E4',
                    value: ethers.utils.parseEther('0.001'),
                    data: ethers.utils.toUtf8Bytes('TEST_INVESTMENT')
                });

                updateStatus(`ğŸ‰ æŠ•èµ„æµ‹è¯•æˆåŠŸ! äº¤æ˜“å“ˆå¸Œ: ${tx.hash.slice(0, 10)}...`, 'success');
                console.log('Investment test transaction:', tx);
            } catch (error) {
                console.error('Investment test error:', error);
                if (error.code === 4001) {
                    updateStatus('âš ï¸ äº¤æ˜“è¢«ç”¨æˆ·å–æ¶ˆ', 'error');
                } else {
                    updateStatus(`âŒ æŠ•èµ„æµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
                }
            }
        }

        async function quickInvest() {
            const amount = document.getElementById('invest-amount').value;
            if (!amount || parseFloat(amount) <= 0) {
                updateStatus('âŒ è¯·è¾“å…¥æœ‰æ•ˆçš„æŠ•èµ„é‡‘é¢', 'error');
                return;
            }

            if (!signer) {
                updateStatus('âŒ è¯·å…ˆè¿æ¥é’±åŒ…', 'error');
                return;
            }

            try {
                updateStatus(`ğŸ¦Š æ­£åœ¨æŠ•èµ„ ${amount} ETHï¼Œè¯·åœ¨MetaMaskä¸­ç¡®è®¤...`, 'info');
                
                const tx = await signer.sendTransaction({
                    to: '0x742d35Cc6634C0532925a3b8D4b8A8FD7E5Da4E4',
                    value: ethers.utils.parseEther(amount),
                    data: ethers.utils.toUtf8Bytes(`INVEST:${amount}`)
                });

                updateStatus(`ğŸ‰ æŠ•èµ„æˆåŠŸ! æŠ•èµ„é‡‘é¢: ${amount} ETH | äº¤æ˜“: ${tx.hash.slice(0, 10)}...`, 'success');
                console.log('Quick investment transaction:', tx);
            } catch (error) {
                console.error('Quick investment error:', error);
                if (error.code === 4001) {
                    updateStatus('âš ï¸ æŠ•èµ„è¢«ç”¨æˆ·å–æ¶ˆ', 'error');
                } else {
                    updateStatus(`âŒ æŠ•èµ„å¤±è´¥: ${error.message}`, 'error');
                }
            }
        }

        async function testTrade(type) {
            const amount = document.getElementById('trade-amount').value;
            const price = document.getElementById('trade-price').value;
            
            if (!amount || !price) {
                updateStatus('âŒ è¯·å¡«å†™äº¤æ˜“æ•°é‡å’Œä»·æ ¼', 'error');
                return;
            }

            if (!signer) {
                updateStatus('âŒ è¯·å…ˆè¿æ¥é’±åŒ…', 'error');
                return;
            }

            try {
                const totalValue = parseFloat(amount) * parseFloat(price);
                updateStatus(`ğŸ¦Š æ­£åœ¨${type === 'buy' ? 'ä¹°å…¥' : 'å–å‡º'}ï¼Œè¯·åœ¨MetaMaskä¸­ç¡®è®¤...`, 'info');
                
                const tx = await signer.sendTransaction({
                    to: '0x742d35Cc6634C0532925a3b8D4b8A8FD7E5Da4E4',
                    value: ethers.utils.parseEther(type === 'buy' ? totalValue.toString() : '0.002'),
                    data: ethers.utils.toUtf8Bytes(`${type.toUpperCase()}:${amount}:${price}`)
                });

                updateStatus(`ğŸ‰ ${type === 'buy' ? 'ä¹°å…¥' : 'å–å‡º'}æˆåŠŸ! äº¤æ˜“: ${tx.hash.slice(0, 10)}...`, 'success');
                console.log('Trade transaction:', tx);
            } catch (error) {
                console.error('Trade error:', error);
                if (error.code === 4001) {
                    updateStatus('âš ï¸ äº¤æ˜“è¢«ç”¨æˆ·å–æ¶ˆ', 'error');
                } else {
                    updateStatus(`âŒ äº¤æ˜“å¤±è´¥: ${error.message}`, 'error');
                }
            }
        }

        async function investInProject(projectId) {
            const amount = prompt('è¯·è¾“å…¥æŠ•èµ„é‡‘é¢ (ETH):', '0.01');
            if (!amount || parseFloat(amount) <= 0) {
                return;
            }

            if (!signer) {
                updateStatus('âŒ è¯·å…ˆè¿æ¥é’±åŒ…', 'error');
                return;
            }

            try {
                updateStatus(`ğŸ¦Š æ­£åœ¨æŠ•èµ„é¡¹ç›® ${projectId}ï¼Œé‡‘é¢: ${amount} ETH...`, 'info');
                
                const tx = await signer.sendTransaction({
                    to: '0x742d35Cc6634C0532925a3b8D4b8A8FD7E5Da4E4',
                    value: ethers.utils.parseEther(amount),
                    data: ethers.utils.toUtf8Bytes(`INVEST:${projectId}:${amount}`)
                });

                updateStatus(`ğŸ‰ é¡¹ç›®æŠ•èµ„æˆåŠŸ! é¡¹ç›®: ${projectId} | é‡‘é¢: ${amount} ETH | äº¤æ˜“: ${tx.hash.slice(0, 10)}...`, 'success');
                console.log('Project investment transaction:', tx);
            } catch (error) {
                console.error('Project investment error:', error);
                if (error.code === 4001) {
                    updateStatus('âš ï¸ æŠ•èµ„è¢«ç”¨æˆ·å–æ¶ˆ', 'error');
                } else {
                    updateStatus(`âŒ æŠ•èµ„å¤±è´¥: ${error.message}`, 'error');
                }
            }
        }

        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨æ£€æŸ¥é’±åŒ…è¿æ¥
        window.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸš€ DeFi Platform ç‹¬ç«‹ç‰ˆæœ¬å·²åŠ è½½');
            updateStatus('ğŸ”— è¯·è¿æ¥MetaMaské’±åŒ…å¼€å§‹æµ‹è¯•', 'info');
        });
    </script>
</body>
</html>